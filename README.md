予防接種情報検索アプリ 基本設計書
version 1.0

　　 作成日：2026-1-6
作成者：大向 なるみ


1. はじめに

 1.1 本書の目的
 1.2 対象範囲（本フェーズのスコープ）
本書では、MVP（Minimum Viable Product）として提供する基本機能および将来拡張を見据えた設計方針を示す。

 1.3 参照資料（要件定義書、画面イメージ等）
 1.4 用語定義

2. システム概要
2.1 システム構成（概念図）
フロントエンド／バックエンド／DB／外部API（将来含む）
 2.2 利用者種別（権限）
一般ユーザー
管理者（運営）
医療機関（将来：施設管理者）



3. 画面設計
3.1 トップ／検索条件入力画面
画面ID
SCR-001
画面名
トップ／検索条件入力画面

目的
利用者が、地域およびワクチン種別を指定して、医療機関の予防接種費用情報を検索できる起点となる画面を提供する。また、初回利用者でも迷わず操作できることを重視する。

対象ユーザー
一般利用者


表示項目
No
項目名
表示形式
必須
表示条件
備考
1
サービス名／ロゴ
テキスト／画像
－
常時
クリックでトップに戻る
2
説明文
テキスト
－
常時
「予防接種費用の目安を検索できます」
3
地域選択
セレクトボックス
〇
常時
都道府県 → 市区町村（段階表示）
4
ワクチン種別
セレクトボックス
〇
常時
マスタ参照
5
検索ボタン
ボタン
－
入力完了時
未入力時は非活性


入力項目・バリデーション
項目
チェック内容
地域
都道府県・市区町村ともに未選択の場合はエラー
ワクチン種別
未選択時は検索不可
共通
全角・半角差異は吸収する


操作・アクション
操作
内容
検索ボタン押下
検索結果一覧画面（SCR-002）へ遷移
ロゴクリック
本画面を再表示（条件リセット）


エラー／空状態
ケース
表示内容
必須未入力
「地域とワクチン種別を選択してください」
システムエラー
「現在検索できません。時間をおいて再度お試しください」



アクセシビリティ配慮
文字サイズはブラウザ標準以上を確保
色のみで状態を判別させない（エラー文はテキスト併記）
キーボード操作で検索可能とする



補足（設計意図）
入力項目は最小限に抑え、検索までの心理的ハードルを下げる
価格表示は次画面に委ね、本画面では「探すこと」に集中させる


※本画面は、医療情報に不慣れな利用者でも操作できることを意識し、入力項目を最小限に抑えた設計としている。


3.2 検索結果一覧画面
画面ID
SCR-002
画面名
検索結果一覧画面
目的
利用者が、指定した検索条件に基づき、予防接種費用の目安を医療機関ごとに比較・確認できる画面を提供する。また、一覧性と比較しやすさを重視し、 詳細確認や公式サイト遷移への導線を明確にする。
対象ユーザー
一般利用者


表示条件
SCR-001（トップ／検索条件入力画面）からの検索実行後に表示される
検索条件が不正な場合は本画面を表示せず、前画面へ戻す


表示項目（一覧）
No
項目名
表示形式
必須
表示条件
備考
1
検索条件サマリ
テキスト
〇
常時
地域／ワクチン名
2
検索結果件数
テキスト
〇
常時
「〇件の医療機関が見つかりました」
3
医療機関名
テキスト
〇
常時
クリック可
4
価格目安
テキスト
〇
常時
中央値表示
5
価格範囲
テキスト
△
件数2以上
min〜max
6
投稿件数
テキスト
〇
常時
「投稿〇件」
7
最終更新目安
テキスト
〇
常時
latest_reported_at
8
距離
テキスト
△
取得可能時
将来：Maps連携
9
詳細ボタン
ボタン
〇
常時
詳細画面へ


表示順・ソート
デフォルト表示順：
 距離（昇順） → 価格目安（昇順）


将来拡張：
・価格順
・距離順
・更新日順
※ MVP では固定順でも可
操作・アクション
操作
内容
医療機関名クリック
医療機関詳細画面（SCR-003）へ遷移
詳細ボタン押下
医療機関詳細画面（SCR-003）へ遷移
戻る
SCR-001 に戻る（条件保持）

空状態・エラー表示
検索結果0件の場合
表示内容
該当する医療機関が見つかりませんでした。
条件を変更して再度検索してください。

補足：
検索条件入力画面への導線を表示
空状態でも不安を与えない文言とする


システムエラー時
表示内容
現在検索結果を取得できません。
時間をおいて再度お試しください。




表示ルール（価格）
表示価格は「目安」であることを明示する
例：
・「約 5,000 円（投稿3件の中央値）」
・「参考価格：8,000 円（投稿1件）」
※ 正確性保証は行わない旨を、画面下部またはツールチップで補足

アクセシビリティ配慮
価格情報は数値＋文言で表現（色のみで区別しない）
タップ領域はスマートフォン操作を前提に十分確保
スクリーンリーダー対応を考慮した構造とする


パフォーマンス・技術考慮（設計メモ）
初期表示はページング対応（例：20件／ページ）
集計済みデータ（price_summary）を優先的に利用
リアルタイム集計は将来検討

補足：
本画面では、価格の「正確さ」よりも比較しやすさと判断材料の提示を重視している。
また、不確実な口コミ情報をそのまま表示せず、代表値・件数・更新目安を併記することで、利用者が自ら判断できる設計としている。


3.3.3 医療機関詳細画面
画面ID
SCR-003
画面名
医療機関詳細画面
目的
検索結果一覧で選択された医療機関について、予防接種費用の目安および関連情報を詳細に提示する。本画面では、価格の正確性を保証しない前提のもと、利用者の判断を支援する情報提供に徹する。
対象ユーザー
一般利用者


表示条件
SCR-002（検索結果一覧画面）から遷移
不正な ID 指定の場合はエラー画面を表示

表示項目（詳細）
医療機関基本情報
No
項目名
表示形式
必須
備考
1
医療機関名
テキスト
〇


2
住所
テキスト
〇
Google Mapsリンク生成
3
電話番号
テキスト
△
タップで発信
4
公式サイトURL
リンク
△
別タブ表示
5
対応ワクチン
テキスト
〇
検索条件のワクチンを強調表示




価格情報（目安）
No
項目名
表示形式
必須
備考
1
価格目安（代表値）
テキスト
〇
中央値
2
価格範囲
テキスト
△
min〜max
3
投稿件数
テキスト
〇
「〇件の投稿」
4
最終更新目安
テキスト
〇
年月表示
5
注意文
テキスト
〇
免責表示


注意文（必須表示）


表示内容
表示されている価格は、利用者から提供された情報をもとにした目安です。最新の正確な費用については、必ず医療機関へ直接ご確認ください。




操作・アクション
操作
内容
公式サイトを見る
医療機関公式サイトへ遷移
Google Mapsで開く
地図アプリまたはWebで表示
価格情報を投稿する
価格投稿画面（SCR-004／将来）
情報を通報する
通報画面（SCR-005／将来）
戻る
検索結果一覧画面へ戻る


※ 投稿・通報機能は将来対応の場合、「準備中」表示でも可

エラー・例外ケース
ケース
表示内容
医療機関情報取得失敗
「情報を取得できませんでした」
価格情報なし
「現在、価格情報の投稿がありません」


アクセシビリティ配慮
長文説明は改行・余白を確保
リンクはアイコン＋テキストで明示
電話番号・URLは誤タップ防止の余白を確保


セキュリティ・運用配慮
価格投稿は匿名、個人情報入力不可
通報は管理者のみ閲覧
医療機関への直接的な評価・優劣表現は行わない

補足：
・本画面では、価格情報の「見せ方」を特に重視している。

・口コミという不確実な情報を扱うため、代表値・件数・更新目安を明示し、判断責任が利用者側にあることを明確にしている。

・医療広告ガイドラインに配慮し、誘導的・断定的な表現は使用しない設計としている。

3.3.4（価格情報投稿画面・将来）








3.3 画面別設計（画面仕様）
（各画面で統一フォーマット）
画面ID
目的
表示項目（ラベル、形式、必須、表示条件）
入力項目（バリデーション含む）
操作（ボタン、アクション）
エラー／空状態（検索0件など）
アクセシビリティ配慮（文字サイズ、コントラスト等）


例：
 3.3.1 トップ／検索条件入力画面
 3.3.2 検索結果一覧画面
 3.3.3 医療機関詳細画面
 3.3.4 価格情報投稿画面（段階導入なら将来）
 3.3.5 通報／問い合わせ画面（将来）
 3.3.6 管理画面ログイン（管理者）
 3.3.7 管理画面：投稿一覧・承認
 3.3.8 管理画面：医療機関マスタ管理

4. データ設計
※ 本データモデルは、口コミ情報という不確実性の高いデータを扱うことを前提とし、正確性の保証ではなく、利用者の意思決定を支援するための参考情報を安定して提供することを目的として設計している。

4.1 論理データモデル
エンティティ一覧
リレーション概要

	<データ設計方針>
本アプリの表示価格は 公式価格の保証ではなく、ユーザー提供情報（口コミ）に基づく“目安” とする。


口コミ情報は そのまま表示せず、集計（中央値など）した代表値を表示する（外れ値・古い情報の影響を抑える）。


初期（MVP）は 個人を特定する情報を保持しない（アカウントなし投稿も可能とする）。


将来、医療機関側が価格を更新できる「施設管理」を追加できるよう、拡張余地を残す。



4.2 テーブル定義（主要）
medical_facility（医療機関）
目的：検索・表示の基礎となる施設情報を保持する。
 	主な項目：
facility_id（PK）
name（施設名）
address（住所：都道府県/市区町村/番地）
prefecture / city（検索用の正規化項目）
lat / lng（緯度経度：距離算出・地図連携用。MVPは任意）
phone（任意）
website_url（任意）
google_maps_place_id（任意：将来のMaps連携用）
created_at / updated_at
補足：MVPでは緯度経度がなくても成立（地図は「住所→Google Mapsリンク」で代替）。
vaccine（ワクチン種別マスタ）
目的：検索条件と表示を統一するため、ワクチン名をマスタ化する。
 主な項目：
vaccine_id（PK）
name（例：インフルエンザ、コロナ、帯状疱疹）
category（例：任意/定期、成人/小児 など。将来）
seasonal_flag（季節性：インフル等）
notes（任意：注意事項や補足）
created_at / updated_at


price_report（価格情報投稿：口コミ）
目的：ユーザーが投稿した“実測価格”を保持する（一次データ）。
 主な項目：
report_id（PK）
facility_id（FK → medical_facility）
vaccine_id（FK → vaccine）
price_yen（金額）
currency（MVPはJPY固定でも可）
dose_count（任意：1回/2回など。将来）
age_group（任意：成人/小児など。将来）
note（任意：例「診察料込みだった」等、ただし個人情報は禁止）
evidence_type（任意：領収書見た/口頭説明/WEB表示など ※アップロードはしない方針でも“申告種別”は持てる）
reported_at（ユーザーが接種・確認した時期）
status（例：PENDING/APPROVED/REJECTED）
created_at / updated_at
補足（重要）：
口コミはそのまま公開せず、承認制（管理者）を推奨。
期限を過ぎた投稿は表示集計から除外する（削除はしない）
※ 将来の分析・監査・不正検知に利用する可能性を考慮し、データ自体は保持する方針とする。


price_summary（集計・代表値：表示用）
目的：画面に表示する代表値（中央値など）を高速に返すための集計結果。
 主な項目：
summary_id（PK）または複合キー（facility_id+vaccine_id）
facility_id（FK）
vaccine_id（FK）
median_price_yen（中央値）
min_price_yen / max_price_yen（参考）
sample_size（集計に使った件数）
latest_reported_at（最新データ日時）
calculated_at（集計日時）
補足：MVPではリアルタイム集計（SQLで計算）でもよいが、将来の性能・安定を考えると price_summary がある方が好ましい。


user_optional（任意：投稿者情報を持つなら）
admin_user（管理者）
moderation_log（承認・却下ログ）

目的：運用・監査（誰が何を承認/却下したか）
 主な項目：
log_id（PK）
report_id（FK）
action（APPROVE/REJECT）
reason_code（例：外れ値、内容不適切、個人情報疑い等）
admin_id（将来：admin_user）
created_at


4.3 リレーション（関係性）
medical_facility 1 — N price_report
 （1つの施設に、複数の価格投稿が紐づく）
vaccine 1 — N price_report
 （1つのワクチン種別に、複数の価格投稿が紐づく）
medical_facility 1 — N price_summary
vaccine 1 — N price_summary
 （施設×ワクチンの組み合わせごとに代表値が存在）
price_report 1 — N moderation_log（任意）
 （投稿の審査履歴を追える）


<制約・ルール>
価格の妥当性チェック（例）
price_yen は 0より大きい整数
上限は仮で設定（例：200,000円以上は要確認＝承認で弾く等）
同一施設×同一ワクチンで、短期間に同額連投が多い場合はスパム疑い（将来）


“古い投稿”の扱い
集計に使う期間を決める（例：直近12か月、または24か月）
期限を過ぎた投稿は表示集計から除外する（削除はしない）

4.4 代表値・集計ロジック
「口コミ価格」をどう表示するか
例：中央値、最新3件の中央値、外れ値除外
更新頻度・失効（古い投稿の扱い）
「目安価格」である免責の扱い
<代表値（集計）ロジック案>
表示価格は中央値（median）を基本にする。理由：外れ値の影響を受けにくい。
 併記情報として：
sample_size（件数）を表示（例：「投稿3件の中央値」）
latest_reported_at（最終更新目安）を表示（例：「最終投稿：2025-11」）


最小表示ルール例
件数 1：その値を“参考価格（1件）”として表示
件数 2以上：中央値＋範囲（min-max）も表示可能

4.5 データ品質・不正対策（基本方針）
同一施設への連投：
短期間に同一条件での投稿が集中した場合、管理者確認対象とする。
明らかに異常値：
事前に設定した上限・下限を超える値は承認前に除外する。
通報・非表示：
利用者または管理者判断により、集計対象外とする。





5. API設計（REST想定）
※ 将来実装を想定するAPI（本フェーズ対象外）
5.1 API一覧
エンドポイント／メソッド／認証要否／概要


5.2 認証・認可
方式（例：セッション、JWT 等）
権限チェック方針（一般／管理者／施設管理者）


5.3 API詳細（主要）
（各APIで統一フォーマット）
概要
Method / Path
リクエスト（Query/Body、例）
レスポンス
ステータスコード（200/400/401/403/404/500）
バリデーション
エラー形式（共通レスポンス）


例：
 5.3.1 ワクチン種別一覧取得 GET /api/v1/vaccines
 5.3.2 医療機関検索 GET /api/v1/facilities?pref=&city=&q=
 5.3.3 医療機関詳細 GET /api/v1/facilities/{id}
 5.3.4 価格情報投稿 POST /api/v1/price-reports（将来なら「将来」明記）
 5.3.5 価格表示用集計 GET /api/v1/price-summary?facilityId=&vaccineId=
 5.3.6 管理：投稿承認 POST /api/v1/admin/price-reports/{id}/approve

6. 外部連携設計（Google Maps等）
6.1 連携方式（段階導入方針）
MVP：地図URLリンク（施設住所から生成）
将来：Maps API による距離計算／地図埋め込み


6.2 キー管理・制限（運用）
APIキーの保護
利用上限・課金リスクの説明



7. 共通設計
7.1 入力チェック（共通）
 7.2 エラー表示／メッセージ方針
 7.3 ログ設計（監査・障害対応）
 7.4 通知（将来：承認結果など）
 7.5 免責・注意文の表示箇所（重要）

8. 非機能（基本設計レベルでの落とし込み）
8.1 性能（検索応答、ページング）
 8.2 可用性（障害時の扱い）
 8.3 セキュリティ（XSS/CSRF、管理画面保護）
 8.4 個人情報（保持しない方針なら明記）
 8.5 運用（価格改定、季節変動、削除依頼）

9. テスト観点（基本設計の範囲で）
正常系：検索〜表示
異常系：0件、必須欠落、不正値
セキュリティ観点：管理者のみ操作できること
集計の妥当性（外れ値・古い投稿）



10. 付録
画面モック（添付）
APIサンプル（curl例）
ER図（添付）
用語集

